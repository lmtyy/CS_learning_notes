第七部分的数学主要集中在 **RBF（径向基函数）网络的行为分析** 以及它与 **线性模型** 在几何上的根本区别。这里没有复杂的推导，更多的是对**函数几何性质**的描述。

我为你剖析其中的数学机理，这有助于理解为什么“加和”与“距离”在高维空间表现得如此不同。

---

### 1. 线性模型 vs. RBF 模型的数学对比

我们来看这两种模型最基本的运算单元（神经元）是如何处理输入 $x$ 的。

#### A. 线性模型 (Linear Unit / ReLU / Maxout)
$$ f(x) = w^T x + b $$
或者经过激活函数：
$$ y = \sigma(w^T x + b) $$

*   **几何意义：** 这是一个**超平面（Hyperplane）**。它把高维空间一分为二。
*   **数学特性（无界性）：**
    *   如果我们沿着 $w$ 的方向一直走（即 $x \to \infty$），$w^T x$ 的值会**无限增大**。
    *   **这对攻击者意味着什么？** 这意味着无论多远，只要方向对，输出就可以被操控得越来越大。这就是 FGSM 能够奏效的根本原因——通过微小的 $\epsilon$，撬动 $w^T \eta$，使激活值暴涨。

#### B. RBF 模型 (Radial Basis Function Unit)
论文中给出的公式：
$$ p(y=1|x) = \exp \left( (x - \mu)^T \beta (x - \mu) \right) $$
通常这里 $\beta$ 是一个负定的对角矩阵（比如 $-\frac{1}{2\sigma^2}I$），或者是负数权重。
标准形式更像这样：
$$ h(x) = \exp \left( - \frac{||x - \mu||^2}{2\sigma^2} \right) $$

*   **符号解释：**
    *   $\mu$：基函数的**中心（Center）**，你可以理解为模型记住的某张“样板猫图片”。
    *   $||x - \mu||^2$：输入 $x$ 和中心 $\mu$ 之间的**欧氏距离**。
    *   $\exp(-\dots)$：高斯函数。距离越远，值衰减得越快。

*   **几何意义：** 这是一个**高维球体（Hypersphere）** 或者说一个小山包。它只在 $\mu$ 附近那一小块区域有响应（值接近1），离开这里全是0。
*   **数学特性（局部性/这正是安全的来源）：**
    *   如果在远处（对抗攻击把 $x$ 推离了流形），$||x - \mu||$ 会变得很大。
    *   $\exp(-\text{很大})$ 会迅速趋近于 **0**。
    *   **结果：** 模型输出 0（低置信度）。它不会像线性模型那样输出一个很大的错误值。它会“拒识”。

### 2. 为什么攻击 RBF 无效？（梯度消失）

如果你试图对 RBF 网络使用 FGSM 攻击，计算梯度会发生什么？

我们要最大化输出 $h(x)$，也就是最小化距离 $||x - \mu||^2$。
梯度是：
$$ \nabla_x h(x) \propto (x - \mu) \cdot h(x) $$

*   **情况 1：** 如果 $x$ 本来就在 $\mu$ 附近（正常图片）。梯度是指向 $\mu$ 的，攻击者只要往反方向走就能让 $h(x)$ 变小。这能攻击成功，但这只是让模型“不认识”它（变成 False Negative），而不是让模型“认错”（False Positive）。
*   **情况 2：** 如果你想要 **Targeted Attack**（比如让 RBF 把“熊猫”认成“长臂猿”）。
    *   你需要把 $x$（熊猫）移动到 $\mu_{gibbon}$（长臂猿的中心）附近。
    *   但是熊猫 $x$ 离长臂猿 $\mu_{gibbon}$ 极其遥远。在那个距离上，RBF 的激活值 $h(x) \approx 0$。
    *   **关键点：** $\exp(-x^2)$ 在远处的导数（梯度）**极其微小，几乎为 0**。
    *   **结果：** 攻击者算出来的梯度是 0。**梯度消失了！** 攻击者找不到方向，不知道往哪推才能把熊猫变成长臂猿。

### 3. 为何放弃 RBF？（维度灾难的数学解释）

虽然 RBF 安全，但论文里用“Precision-Recall”一笔带过的问题，背后有一个更深刻的数学诅咒：**维度灾难 (Curse of Dimensionality)**。

要在 $n$ 维空间里用 RBF 覆盖整个流形，需要的 RBF 单元数量 $K$ 是指数级增长的。
$$ K \approx C^n $$
*   如果 $n=1$（一维直线），你可能需要 10 个 RBF 就能覆盖区间。
*   如果 $n=784$（MNIST图片），你需要 $10^{784}$ 个 RBF 单元才能填满图片空间。
*   **线性模型**之所以强，是因为它用**参数 $w$** 换取了空间。一个 hyperplane 可以切分整个无限大的空间。

### 总结

*   **线性模型（点积 $w^T x$）：**
    *   数学：全局线性，无界。
    *   后果：容易训练，泛化强，但容易被对抗扰动无限放大。
*   **RBF 模型（距离 $||x-\mu||$）：**
    *   数学：局部响应，指数衰减。
    *   后果：天然拒绝“瞎猜”（安全），梯度在远处消失（难攻击），但无法处理高维数据（难训练、难覆盖）。

这就是为什么 Goodfellow 说：“Linear units and RBF units as different points on a precision-recall tradeoff curve.”（一个是广撒网，一个是死脑筋）。