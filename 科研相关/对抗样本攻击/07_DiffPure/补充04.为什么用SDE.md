简单直接的回答：**是的，DiffPure 的默认核心设置是 SDE（随机方程），对应的是连续时间的 DDPM 变体，而不是 DDIM。**

一定要区分清楚这两个概念，因为这直接决定了你复现时的代码路径和防御效果。

### 1. 论文原文的铁证

请翻到 **Section 5.5 (Ablation studies)** 以及 **Table 6**。

DiffPure 的作者专门做了一个对比实验，对比了三种采样策略：
1.  **VP-SDE (Ours)**: 这就是论文主推的方法。它对应连续时间的 DDPM，整个逆向过程带有随机噪声 $dw$（Wiener Process）。
2.  **VP-ODE**: 这对应连续时间的 **DDIM**（Probability Flow ODE）。它的轨迹是确定性的，没有随机噪声。
3.  **LD-SDE**: 基于朗之万动力学（Langevin Dynamics）的采样。

**结果非常震撼（Table 6）：**
*   **VP-SDE (DiffPure)**: Robust Accuracy（鲁棒精度） **70.64%**
*   **VP-ODE (类 DDIM)**: Robust Accuracy（鲁棒精度） **39.86%**

### 2. 为什么不用 DDIM (ODE)？

这回到你刚才问的“语义丢失”和“确定性”的问题上了。在防御这一块，**随机性（Stochasticity）是极其重要的护城河**。

*   **DDIM/ODE（确定性）**：
    攻击者也是聪明的。如果你用来净化的路径是确定的（像地图上的导航路线一样死板），攻击者可以用 **BPDA (Backpropagation through Differentiable Approximation)** 或者 **Adjoint Method** 直接算出你这条净化路径的精确梯度。
    *通俗说：因为你的走位是固定的，攻击者可以预判你的预判，直接把攻击埋在你必经之路上。*

*   **SDE/DDPM（随机性）**：
    DiffPure 使用的 SDE 求解器（Euler-Maruyama method），每一步都会注入随机噪声。
    这意味着：即使是同一张图，你净化两次，得到的像素结果都会有微小差异。
    *通俗说：你的走位是带“醉拳”性质的。攻击者想算梯度攻击你，但发现梯度里全是随机噪声（Gradient Variance），攻击效果大打折扣。*

### 3. 复现时的注意点

既然你在复现代码，你要特别注意 `torchsde` 的部分。

*   **代码逻辑**：
    DiffPure 使用的是 `torchsde.sdeint`（SDE 积分器）。
    它求解的是论文 **Equation (4)**：
    $$ \hat{x}(0) = \text{sdeint}(x(t^*), f_{rev}, g_{rev}, w, t^*, 0) $$
    这里的 $g_{rev}$ 就是扩散系数（噪声项）。

*   **如果是 DDIM (ODE)**：
    公式里的 $g(t)dw$ 项会消失或被转化为确定性项，代码里通常会变成 `odeint` 或者简单的 for 循环确定性迭代。

### 总结

DiffPure **=** **Continuous-time DDPM (SDE)**。
它利用了扩散模型的强大生成能力（把图修好）+ SDE 的随机性（让攻击者算不准梯度）。

如果你把你复现的代码强行改成 DDIM 采样（比如为了加速），你会发现**防御效果（Robust Accuracy）会直接崩盘**。千万别改！