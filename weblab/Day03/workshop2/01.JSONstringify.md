## `JSON.stringify()` 概述

`JSON.stringify()` 是将 JavaScript 值转换为 JSON 字符串的方法。

### 基本语法
```javascript
JSON.stringify(value[, replacer[, space]])
```

## 基本用法

### 1. 简单转换
```javascript
const obj = {
  name: "张三",
  age: 25,
  city: "北京"
};

const jsonString = JSON.stringify(obj);
console.log(jsonString);
// 输出: '{"name":"张三","age":25,"city":"北京"}'
```

### 2. 转换数组
```javascript
const arr = [1, "hello", true, null];
const jsonString = JSON.stringify(arr);
console.log(jsonString);
// 输出: '[1,"hello",true,null]'
```

## 参数详解

### replacer 参数

#### 作为函数使用
```javascript
const obj = {
  name: "李四",
  age: 30,
  password: "secret123",
  email: "lisi@example.com"
};

// 过滤掉 password 属性
const result = JSON.stringify(obj, (key, value) => {
  if (key === "password") {
    return undefined; // 该属性不会被包含在结果中
  }
  return value;
});

console.log(result);
// 输出: '{"name":"李四","age":30,"email":"lisi@example.com"}'
```

#### 作为数组使用
```javascript
const obj = {
  name: "王五",
  age: 28,
  city: "上海",
  country: "中国",
  occupation: "工程师"
};

// 只保留指定的属性
const result = JSON.stringify(obj, ['name', 'age', 'city']);
console.log(result);
// 输出: '{"name":"王五","age":28,"city":"上海"}'
```

### space 参数（格式化）

```javascript
const obj = {
  name: "赵六",
  hobbies: ["阅读", "游泳", "编程"],
  address: {
    street: "人民路",
    number: 123
  }
};

// 使用 2 个空格缩进
console.log(JSON.stringify(obj, null, 2));
/*
输出:
{
  "name": "赵六",
  "hobbies": [
    "阅读",
    "游泳",
    "编程"
  ],
  "address": {
    "street": "人民路",
    "number": 123
  }
}
*/

// 使用制表符缩进
console.log(JSON.stringify(obj, null, '\t'));
```

## 特殊情况的处理

### 1. 不可序列化的值
```javascript
const obj = {
  name: "测试",
  func: function() {}, // 函数会被忽略
  undefined: undefined, // undefined 会被忽略
  symbol: Symbol('test'), // Symbol 会被忽略
  infinity: Infinity,
  date: new Date() // Date 对象会转为字符串
};

console.log(JSON.stringify(obj));
// 输出: '{"name":"测试","infinity":null,"date":"2023-07-20T12:00:00.000Z"}'
```

### 2. 循环引用问题
```javascript
const obj = { name: "循环引用测试" };
obj.self = obj; // 循环引用

try {
  JSON.stringify(obj);
} catch (error) {
  console.log("错误:", error.message);
  // 输出: 错误: Converting circular structure to JSON
}
```

## 实际应用场景

### 1. 本地存储
```javascript
const userSettings = {
  theme: "dark",
  language: "zh-CN",
  notifications: true
};

// 存储到 localStorage
localStorage.setItem('userSettings', JSON.stringify(userSettings));

// 从 localStorage 读取
const storedSettings = JSON.parse(localStorage.getItem('userSettings'));
```

### 2. API 请求
```javascript
const postData = {
  title: "我的文章",
  content: "这是文章内容",
  tags: ["技术", "JavaScript"]
};

// 发送 POST 请求
fetch('/api/posts', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(postData)
});
```

### 3. 深度拷贝对象
```javascript
function deepClone(obj) {
  return JSON.parse(JSON.stringify(obj));
}

const original = { 
  name: "原始对象", 
  nested: { value: 123 } 
};
const cloned = deepClone(original);

console.log(cloned); // 与 original 相同
console.log(cloned === original); // false，是不同的对象
```

## 自定义 toJSON 方法

你可以为对象定义 `toJSON` 方法来控制序列化行为：

```javascript
const person = {
  name: "钱七",
  age: 35,
  secret: "不该暴露的信息",
  toJSON: function() {
    return {
      name: this.name,
      age: this.age,
      isAdult: this.age >= 18
    };
  }
};

console.log(JSON.stringify(person));
// 输出: '{"name":"钱七","age":35,"isAdult":true}'
```

## ==注意事项==

1. **安全考虑**：不要使用 `JSON.stringify()` 来处理来自不受信任源的数据
2. **性能**：对于大型对象，序列化可能比较耗时
3. **数据类型丢失**：某些 JavaScript 特有的类型（如 Date、Map、Set）在序列化时会丢失类型信息

希望这个详细的讲解对您有帮助！`JSON.stringify()` 是 JavaScript 开发中非常基础和重要的方法。