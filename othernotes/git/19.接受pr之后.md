æ¥å—ï¼ˆåˆå¹¶ï¼‰PR åï¼Œéœ€è¦æ‰§è¡Œä¸€ç³»åˆ—åç»­æ“ä½œã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„ **PR åˆå¹¶åå·¥ä½œæµç¨‹**ï¼š

## ä¸€ã€åˆå¹¶ PR çš„å‡ ç§æ–¹å¼

åœ¨åˆå¹¶å‰ï¼Œä½ éœ€è¦é€‰æ‹©åˆé€‚çš„åˆå¹¶ç­–ç•¥ï¼š

### **1. ç½‘é¡µç«¯åˆå¹¶ï¼ˆGitHub/GitLabï¼‰**
```markdown
ç‚¹å‡» Merge pull request æŒ‰é’®ï¼Œæœ‰ 3 ç§é€‰é¡¹ï¼š
- **Create a merge commit**ï¼ˆæ¨èï¼‰ï¼šä¿ç•™å®Œæ•´å†å²
  ```
  git merge --no-ff feature-branch
  ```
- **Squash and merge**ï¼šå¤šä¸ªæäº¤åˆå¹¶ä¸º 1 ä¸ª
  ```
  git merge --squash feature-branch
  ```
- **Rebase and merge**ï¼šçº¿æ€§å†å²ï¼ˆGitLab ç§° Fast-forwardï¼‰
```

### **2. å‘½ä»¤è¡Œåˆå¹¶**
```bash
# ç¡®ä¿åœ¨ä¸»åˆ†æ”¯
git checkout main

# æ›´æ–°ä¸»åˆ†æ”¯
git pull origin main

# åˆå¹¶ PR åˆ†æ”¯
git merge --no-ff pr-branch-name

# æˆ–ä½¿ç”¨ squashï¼ˆæ¸…ç†æäº¤å†å²ï¼‰
git merge --squash pr-branch-name
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½ (#123)"

# æ¨é€
git push origin main
```

### **3. ä½¿ç”¨ GitHub CLI åˆå¹¶**
```bash
# æŸ¥çœ‹ PR çŠ¶æ€
gh pr view 123

# åˆå¹¶ PR
gh pr merge 123 --merge  # æˆ– --squash, --rebase

# ç¤ºä¾‹ï¼šåˆå¹¶å¹¶åˆ é™¤è¿œç¨‹åˆ†æ”¯
gh pr merge 123 --merge --delete-branch

# ç¤ºä¾‹ï¼šä½¿ç”¨ squash åˆå¹¶
gh pr merge 123 --squash --body "åˆå¹¶ PR #123"

# æŸ¥çœ‹å¸®åŠ©
gh pr merge --help
```

## äºŒã€åˆå¹¶åçš„ç«‹å³æ“ä½œ

### **1. éªŒè¯åˆå¹¶ç»“æœ**
```bash
# æ£€æŸ¥æœ€æ–°æäº¤
git log --oneline -5

# æŸ¥çœ‹åˆå¹¶æäº¤
git show HEAD

# éªŒè¯æ„å»º
npm run build

# è¿è¡Œæµ‹è¯•ç¡®ä¿åˆå¹¶æ²¡ç ´ååŠŸèƒ½
npm test

# æ£€æŸ¥å†²çªè§£å†³æ˜¯å¦æ­£ç¡®
git status
```

### **2. æ›´æ–°æœ¬åœ°ç¯å¢ƒ**
```bash
# æ‹‰å–æœ€æ–°çš„ä¸»åˆ†æ”¯
git checkout main
git pull origin main

# å¦‚æœä½¿ç”¨åŠŸèƒ½åˆ†æ”¯å¼€å‘ï¼ŒåŒæ­¥åˆ°ä½ çš„åˆ†æ”¯
git checkout your-feature-branch
git rebase main
# æˆ–
git merge main
```

### **3. æ¸…ç†æœ¬åœ°åˆ†æ”¯**
```bash
# åˆ é™¤å·²åˆå¹¶çš„æœ¬åœ°åˆ†æ”¯
git branch -d pr-branch-name

# å¼ºåˆ¶åˆ é™¤ï¼ˆå¦‚æœè¿˜æ²¡å®Œå…¨åˆå¹¶ï¼‰
git branch -D pr-branch-name

# æ‰¹é‡æ¸…ç†å·²åˆå¹¶çš„åˆ†æ”¯
git branch --merged main | grep -v "^\*" | xargs git branch -d

# åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼ˆé€šå¸¸ PR é¡µé¢æœ‰é€‰é¡¹è‡ªåŠ¨åˆ é™¤ï¼‰
git push origin --delete pr-branch-name
```

## ä¸‰ã€ä»£ç åˆå¹¶åçš„å›¢é˜Ÿåä½œ

### **1. é€šçŸ¥å›¢é˜Ÿæˆå‘˜**
```bash
# åœ¨å›¢é˜ŸèŠå¤©å·¥å…·ä¸­é€šçŸ¥
# Slack/Teams/Discord æ¶ˆæ¯æ¨¡æ¿ï¼š
"""
ğŸš€ PR #123 å·²åˆå¹¶åˆ° main
å˜æ›´ï¼šä¿®å¤ç”¨æˆ·ç™»å½• bug
ä½œè€…ï¼š@username
å½±å“ï¼šæ‰€æœ‰ç”¨æˆ·ç™»å½•ç›¸å…³åŠŸèƒ½
éƒ¨ç½²è®¡åˆ’ï¼šä»Šå¤©ä¸‹åˆ 3 ç‚¹
æŸ¥çœ‹ï¼šhttps://github.com/org/repo/commit/abc123
"""
```

### **2. æ›´æ–°é¡¹ç›®æ–‡æ¡£**
```markdown
## CHANGELOG.md æ›´æ–°ç¤ºä¾‹

### [Unreleased]
#### Added
- æ–°åŠŸèƒ½ï¼šç”¨æˆ·å¤šå› ç´ è®¤è¯ (#123)
- API ç«¯ç‚¹ `/api/v2/auth/mfa`

#### Fixed
- ä¿®å¤ç™»å½•æ—¶çš„ XSS æ¼æ´ (#123)
- è§£å†³ä¼šè¯è¿‡æœŸæ—¶é—´ä¸æ­£ç¡®çš„é—®é¢˜

---

## API_DOCS.md æ›´æ–°
### è®¤è¯ç«¯ç‚¹
- æ–°å¢ `POST /api/v2/auth/mfa`
  è¯·æ±‚ï¼š`{ "token": "123456" }`
  å“åº”ï¼š`{ "verified": true }`
```

### **3. åˆ›å»º Git æ ‡ç­¾ï¼ˆå¦‚éœ€è¦ï¼‰**
```bash
# ä¸ºé‡è¦åŠŸèƒ½åˆ›å»ºæ ‡ç­¾
git tag -a v1.2.0 -m "å‘å¸ƒç”¨æˆ·è®¤è¯å¢å¼ºåŠŸèƒ½"
git push origin v1.2.0

# æˆ–ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬
git tag -a v1.2.0-rc.1 -m "Release candidate for MFA feature"
```

## å››ã€éƒ¨ç½²ä¸å‘å¸ƒæµç¨‹

### **1. è§¦å‘ CI/CD æµæ°´çº¿**
```yaml
# .github/workflows/deploy.yml ç¤ºä¾‹
name: Deploy
on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Build and Test
        run: |
          npm ci
          npm test
          npm run build
          
      - name: Deploy to Staging
        if: github.ref == 'refs/heads/main'
        run: |
          echo "Deploying to staging..."
          # éƒ¨ç½²å‘½ä»¤
```

### **2. ç¯å¢ƒéƒ¨ç½²é¡ºåº**
```mermaid
æµç¨‹ï¼š
å¼€å‘ç¯å¢ƒï¼ˆè‡ªåŠ¨ï¼‰ â†’ æµ‹è¯•ç¯å¢ƒï¼ˆæ‰‹åŠ¨ï¼‰ â†’ é¢„ç”Ÿäº§ç¯å¢ƒ â†’ ç”Ÿäº§ç¯å¢ƒ
```

```bash
# æ‰‹åŠ¨è§¦å‘éƒ¨ç½²åˆ°ç‰¹å®šç¯å¢ƒ
# ä½¿ç”¨éƒ¨ç½²å·¥å…·æˆ–è„šæœ¬
./deploy.sh --env staging
./deploy.sh --env production
```

### **3. ç›‘æ§éƒ¨ç½²çŠ¶æ€**
```bash
# æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
kubectl get pods -n production
kubectl logs deployment/app-deployment

# æˆ–æŸ¥çœ‹äº‘æœåŠ¡å•†æ§åˆ¶å°
# AWS/GCP/Azure éƒ¨ç½²çŠ¶æ€
```

## äº”ã€éªŒè¯ç”Ÿäº§ç¯å¢ƒ

### **1. å¥åº·æ£€æŸ¥**
```bash
# æµ‹è¯•ç”Ÿäº§ç¯å¢ƒ API
curl https://api.example.com/health
# é¢„æœŸï¼š{"status":"healthy","version":"1.2.0"}

# æµ‹è¯•æ–°åŠŸèƒ½ç«¯ç‚¹
curl -X POST https://api.example.com/api/v2/auth/mfa \
  -H "Authorization: Bearer token" \
  -d '{"code":"123456"}'
```

### **2. ç›‘æ§æŒ‡æ ‡**
```bash
# æŸ¥çœ‹é”™è¯¯ç‡
# ä½¿ç”¨ç›‘æ§å·¥å…·ï¼šDatadog, New Relic, Prometheus

# æ£€æŸ¥æ—¥å¿—ä¸­çš„é”™è¯¯
grep "ERROR" production.log | tail -20

# éªŒè¯æ€§èƒ½æŒ‡æ ‡
# å“åº”æ—¶é—´ã€ååé‡ã€é”™è¯¯ç‡
```

### **3. ç”¨æˆ·åé¦ˆæ”¶é›†**
```markdown
## åˆ›å»ºåé¦ˆ issue
æ ‡é¢˜ï¼šéªŒè¯æ–°ç™»å½•åŠŸèƒ½ v1.2.0
å†…å®¹ï¼š
è¯·æµ‹è¯•å›¢é˜ŸéªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š
1. [ ] å¤šå› ç´ è®¤è¯è®¾ç½®
2. [ ] ç™»å½•æµç¨‹
3. [ ] é”™è¯¯å¤„ç†
4. [ ] ç§»åŠ¨ç«¯å…¼å®¹æ€§

æŠ¥å‘Šé—®é¢˜åˆ°ï¼š#feedback é¢‘é“
```

## å…­ã€åç»­ç»´æŠ¤ä»»åŠ¡

### **1. é—®é¢˜è¿½è¸ªä¸ä¿®å¤**
```bash
# å¦‚æœå‘ç°é—®é¢˜ï¼Œç«‹å³åˆ›å»º hotfix
git checkout -b hotfix/login-issue
# ä¿®å¤é—®é¢˜
git commit -m "fix: ä¿®å¤ç™»å½• token è¿‡æœŸé—®é¢˜"
git push origin hotfix/login-issue

# åˆ›å»ºç´§æ€¥ PR
gh pr create --title "ç´§æ€¥ä¿®å¤ï¼šç™»å½•é—®é¢˜" --body "é—®é¢˜æè¿°..."
```

### **2. å›æ»šè®¡åˆ’ï¼ˆå¦‚æœéœ€è¦ï¼‰**
```bash
# å›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬
git revert HEAD~1  # æ’¤é”€æœ€æ–°åˆå¹¶
# æˆ–
git revert <merge-commit-hash>

# åˆ›å»ºå›æ»š PR
gh pr create --title "å›æ»šï¼šç™»å½•åŠŸèƒ½" --body "åŸå› ï¼šç”Ÿäº§ç¯å¢ƒé—®é¢˜"
```

### **3. çŸ¥è¯†åˆ†äº«**
```markdown
## å›¢é˜Ÿå†…éƒ¨åˆ†äº«
### ä¸»é¢˜ï¼šæ–°ç™»å½•åŠŸèƒ½å®ç°ç»†èŠ‚
æ—¶é—´ï¼šæœ¬å‘¨äº” 10:00
å†…å®¹ï¼š
1. æŠ€æœ¯æ¶æ„å˜åŒ–
2. æµ‹è¯•è¦ç‚¹
3. è¿ç»´æ³¨æ„äº‹é¡¹
4. æ•…éšœæ’é™¤æŒ‡å—

æ–‡æ¡£é“¾æ¥ï¼šConfluence/Notion é¡µé¢
```

## ä¸ƒã€è‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹

### **åˆå¹¶åè‡ªåŠ¨åŒ–è„šæœ¬**
```bash
#!/bin/bash
# post-merge.sh
# è‡ªåŠ¨æ‰§è¡Œåˆå¹¶åä»»åŠ¡

PR_NUMBER=$1
PR_TITLE=$(gh pr view $PR_NUMBER --json title --jq '.title')

echo "ğŸš€ å¤„ç† PR #$PR_NUMBER: $PR_TITLE"

# 1. æ›´æ–°æœ¬åœ°
git checkout main
git pull origin main

# 2. è¿è¡Œæµ‹è¯•
echo "è¿è¡Œæµ‹è¯•..."
npm test

# 3. æ›´æ–° CHANGELOG
echo "æ›´æ–° CHANGELOG..."
node scripts/update-changelog.js $PR_NUMBER "$PR_TITLE"

# 4. é€šçŸ¥å›¢é˜Ÿ
echo "é€šçŸ¥å›¢é˜Ÿ..."
curl -X POST $SLACK_WEBHOOK \
  -d '{"text":"PR #'$PR_NUMBER' å·²åˆå¹¶: '$PR_TITLE'"}'

# 5. è§¦å‘éƒ¨ç½²
echo "è§¦å‘æµ‹è¯•ç¯å¢ƒéƒ¨ç½²..."
gh workflow run deploy.yml --ref main
```

### **CHANGELOG æ›´æ–°è„šæœ¬**
```javascript
// scripts/update-changelog.js
const fs = require('fs');
const prNumber = process.argv[2];
const prTitle = process.argv[3];

const changelog = fs.readFileSync('CHANGELOG.md', 'utf8');
const today = new Date().toISOString().split('T')[0];

const newEntry = `\n### ${today}\n- ${prTitle} (#${prNumber})\n`;

// åœ¨ ## [Unreleased] éƒ¨åˆ†æ·»åŠ 
const updated = changelog.replace('## [Unreleased]', `## [Unreleased]\n${newEntry}`);
fs.writeFileSync('CHANGELOG.md', updated);
```

## å…«ã€æœ€ä½³å®è·µæ¸…å•

### **åˆå¹¶åæ£€æŸ¥æ¸…å•**
```markdown
## âœ… PR åˆå¹¶åæ£€æŸ¥æ¸…å•

### ä»£ç å±‚é¢
- [ ] æ‰€æœ‰ CI æ£€æŸ¥é€šè¿‡
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸ
- [ ] æµ‹è¯•è¦†ç›–ç‡æœªä¸‹é™
- [ ] ä»£ç å®¡æŸ¥æ„è§å·²å¤„ç†
- [ ] ä¾èµ–åº“å·²æ›´æ–°ï¼ˆå¦‚æœ‰ï¼‰

### æ–‡æ¡£æ›´æ–°
- [ ] CHANGELOG å·²æ›´æ–°
- [ ] API æ–‡æ¡£å·²åŒæ­¥
- [ ] README æ›´æ–°ï¼ˆå¦‚æœ‰æ¥å£å˜æ›´ï¼‰
- [ ] è¿ç§»æŒ‡å—ï¼ˆå¦‚æœ‰ç ´åæ€§å˜æ›´ï¼‰

### éƒ¨ç½²éªŒè¯
- [ ] æµ‹è¯•ç¯å¢ƒéƒ¨ç½²æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æ–°åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] ç›‘æ§å‘Šè­¦é…ç½®æ›´æ–°

### å›¢é˜Ÿæ²Ÿé€š
- [ ] ç›¸å…³å›¢é˜Ÿå·²é€šçŸ¥
- [ ] å®¢æœ/æ”¯æŒå›¢é˜ŸçŸ¥æ™“å˜æ›´
- [ ] åˆ›å»ºéªŒè¯ä»»åŠ¡
- [ ] å®‰æ’çŸ¥è¯†åˆ†äº«
```

## ä¹ã€å¸¸è§é—®é¢˜å¤„ç†

### **1. åˆå¹¶åå‘ç°é—®é¢˜**
```bash
# ç«‹å³åˆ›å»ºä¿®å¤åˆ†æ”¯
git checkout -b hotfix/issue-description

# å¿«é€Ÿä¿®å¤
# ...

# åˆ›å»ºç´§æ€¥ PR
gh pr create --base main --title "ç´§æ€¥ä¿®å¤" --body "é—®é¢˜æè¿°..."

# ä½¿ç”¨ /urgent æ ‡ç­¾åŠ é€Ÿå®¡æŸ¥
```

### **2. éœ€è¦éƒ¨åˆ†å›æ»š**
```bash
# åªå›æ»šæŸä¸ªæ–‡ä»¶çš„å˜æ›´
git checkout HEAD~1 -- path/to/file.js
git commit -m "revert: éƒ¨åˆ†å›æ»šæ–‡ä»¶"

# æˆ–ä½¿ç”¨ git revert æŒ‡å®šæ–‡ä»¶
git revert -n <commit>  # ä¸è‡ªåŠ¨æäº¤
git reset HEAD  # å–æ¶ˆæ‰€æœ‰æš‚å­˜
git add path/to/keep.js  # åªæ·»åŠ è¦ä¿ç•™çš„æ–‡ä»¶
git commit -m "é€‰æ‹©æ€§å›æ»š"
```

### **3. ä¾èµ–å†²çª**
```bash
# æ›´æ–° package.json å†²çª
npm install  # å®‰è£…æœ€æ–°ä¾èµ–
npm audit fix  # ä¿®å¤å®‰å…¨é—®é¢˜

# æ›´æ–° lock æ–‡ä»¶
rm package-lock.json
npm install

# éªŒè¯ä¾èµ–
npm ls  # æŸ¥çœ‹ä¾èµ–æ ‘
```

## åã€æ€»ç»“å·¥ä½œæµ

```mermaid
graph TD
    A[æ¥å— PR] --> B[é€‰æ‹©åˆå¹¶ç­–ç•¥]
    B --> C[æ‰§è¡Œåˆå¹¶]
    C --> D[æœ¬åœ°éªŒè¯]
    D --> E[æ¸…ç†åˆ†æ”¯]
    E --> F[è§¦å‘ CI/CD]
    F --> G[éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ]
    G --> H[éªŒè¯åŠŸèƒ½]
    H --> I[éƒ¨ç½²åˆ°ç”Ÿäº§]
    I --> J[ç›‘æ§ä¸å‘Šè­¦]
    J --> K[çŸ¥è¯†åˆ†äº«]
    K --> L[å®Œæˆ]
```

è®°ä½ï¼š**åˆå¹¶ PR åªæ˜¯å¼€å§‹ï¼Œä¸æ˜¯ç»“æŸ**ã€‚è‰¯å¥½çš„åç»­æµç¨‹èƒ½ç¡®ä¿ä»£ç è´¨é‡ã€å›¢é˜Ÿåä½œå’Œç”Ÿäº§ç¨³å®šæ€§ã€‚