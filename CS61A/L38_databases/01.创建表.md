好的！创建表是 SQL 中最基础且重要的操作之一。我们来详细讲解 `CREATE TABLE` 语句的完整语法。

### 一、最基本的 CREATE TABLE 语法

```sql
CREATE TABLE table_name (
    column1 datatype,
    column2 datatype,
    column3 datatype,
    ...
);
```

#### 示例：创建一个简单的用户表
```sql
CREATE TABLE users (
    id INTEGER,
    name TEXT,
    email TEXT,
    age INTEGER
);
```

---

### 二、完整的语法结构

```sql
CREATE TABLE table_name (
    column_name data_type [column_constraint] [DEFAULT default_value],
    column_name data_type [column_constraint] [DEFAULT default_value],
    ...
    [table_constraint]
);
```

---

### 三、数据类型（Data Types）

不同的数据库支持的数据类型略有不同，但常见的有：

#### 1. 数值类型
| 类型 | 描述 | 示例 |
|------|------|------|
| `INTEGER` | 整数 | `age INTEGER` |
| `BIGINT` | 大整数 | `population BIGINT` |
| `DECIMAL(p, s)` | 精确小数 | `price DECIMAL(10, 2)` |
| `FLOAT` / `REAL` | 浮点数 | `weight FLOAT` |
| `NUMERIC` | 数字 | `rating NUMERIC(3, 1)` |

#### 2. 字符串类型
| 类型 | 描述 | 示例 |
|------|------|------|
| `VARCHAR(n)` | 可变长度字符串 | `name VARCHAR(100)` |
| `CHAR(n)` | 固定长度字符串 | `gender CHAR(1)` |
| `TEXT` | 长文本 | `description TEXT` |

#### 3. 日期时间类型
| 类型 | 描述 | 示例 |
|------|------|------|
| `DATE` | 日期 | `birthdate DATE` |
| `TIME` | 时间 | `start_time TIME` |
| `TIMESTAMP` | 日期时间 | `created_at TIMESTAMP` |
| `DATETIME` | 日期时间 | `updated_at DATETIME` |

#### 4. 其他类型
| 类型 | 描述 | 示例 |
|------|------|------|
| `BOOLEAN` | 布尔值 | `is_active BOOLEAN` |
| `BLOB` | 二进制数据 | `photo BLOB` |
| `JSON` | JSON 数据 | `metadata JSON` |

---

### 四、列约束（Column Constraints）

列约束定义了列的规则和限制。

#### 1. `PRIMARY KEY` - 主键
唯一标识每行，不能为 NULL。
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    name TEXT,
    ...
);
```

#### 2. `AUTOINCREMENT` / `IDENTITY` - 自增
自动生成唯一值（通常用于主键）。
```sql
-- SQLite
id INTEGER PRIMARY KEY AUTOINCREMENT

-- MySQL
id INT PRIMARY KEY AUTO_INCREMENT

-- PostgreSQL
id SERIAL PRIMARY KEY

-- SQL Server
id INT IDENTITY(1,1) PRIMARY KEY
```

#### 3. `UNIQUE` - 唯一约束
确保列中的所有值都不相同。
```sql
email TEXT UNIQUE
```

#### 4. `NOT NULL` - 非空约束
确保列不能包含 NULL 值。
```sql
name TEXT NOT NULL
```

#### 5. `CHECK` - 检查约束
定义列值的条件。
```sql
age INTEGER CHECK (age >= 0 AND age <= 150)
```

#### 6. `DEFAULT` - 默认值
指定列的默认值。
```sql
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
is_active BOOLEAN DEFAULT TRUE
```

#### 7. `FOREIGN KEY` - 外键
建立表之间的关系。
```sql
user_id INTEGER REFERENCES users(id)
```

---

### 五、表约束（Table Constraints）

在表级别定义的约束，可以涉及多个列。

#### 1. 复合主键
```sql
CREATE TABLE order_items (
    order_id INTEGER,
    product_id INTEGER,
    quantity INTEGER,
    PRIMARY KEY (order_id, product_id)
);
```

#### 2. 复合唯一约束
```sql
CREATE TABLE user_roles (
    user_id INTEGER,
    role_id INTEGER,
    UNIQUE (user_id, role_id)
);
```

#### 3. 表级检查约束
```sql
CREATE TABLE products (
    price DECIMAL(10, 2),
    discount DECIMAL(10, 2),
    CHECK (price >= discount AND discount >= 0)
);
```

#### 4. 表级外键约束
```sql
CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY,
    user_id INTEGER,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

---

### 六、综合示例

#### 示例1：完整的用户表
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    birth_date DATE,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHECK (email LIKE '%@%')
);
```

#### 示例2：订单和订单项（带外键）
```sql
-- 订单表
CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total_amount DECIMAL(10, 2) CHECK (total_amount >= 0),
    status VARCHAR(20) DEFAULT 'pending',
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- 订单项表
CREATE TABLE order_items (
    order_item_id INTEGER PRIMARY KEY AUTOINCREMENT,
    order_id INTEGER NOT NULL,
    product_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    unit_price DECIMAL(10, 2) NOT NULL CHECK (unit_price >= 0),
    FOREIGN KEY (order_id) REFERENCES orders(order_id),
    FOREIGN KEY (product_id) REFERENCES products(product_id)
);
```

---

### 七、高级创建选项

#### 1. 从查询结果创建表
```sql
CREATE TABLE high_value_customers AS
SELECT customer_id, name, total_spent
FROM customers
WHERE total_spent > 10000;
```

#### 2. 临时表
只在当前会话中存在，会话结束自动删除。
```sql
CREATE TEMPORARY TABLE temp_results (
    id INTEGER,
    result_value DECIMAL(10, 2)
);
```

#### 3. 带存储选项（数据库特定）
```sql
-- MySQL
CREATE TABLE large_table (
    id INT PRIMARY KEY,
    data TEXT
) ENGINE=InnoDB ROW_FORMAT=COMPRESSED;

-- PostgreSQL
CREATE TABLE logs (
    log_id SERIAL PRIMARY KEY,
    log_data JSONB
) WITH (FILLFACTOR = 70);
```

---

### 八、修改和删除表

#### 1. 修改表结构（ALTER TABLE）
```sql
-- 添加新列
ALTER TABLE users ADD COLUMN phone_number VARCHAR(15);

-- 修改列类型
ALTER TABLE users ALTER COLUMN age TYPE SMALLINT;

-- 删除列
ALTER TABLE users DROP COLUMN phone_number;

-- 添加约束
ALTER TABLE users ADD CONSTRAINT chk_age CHECK (age >= 0);
```

#### 2. 删除表
```sql
-- 删除表（包括所有数据）
DROP TABLE table_name;

-- 如果表存在才删除
DROP TABLE IF EXISTS table_name;
```

---

### 九、最佳实践

1. **命名规范**：使用有意义的表名和列名（蛇形命名法：user_id）
2. **主键**：每个表都应该有主键
3. **外键**：建立表之间的关系，维护数据完整性
4. **约束**：适当使用约束来保证数据质量
5. **默认值**：为常用列设置合理的默认值
6. **注释**：添加注释说明表和列的用途
```sql
COMMENT ON TABLE users IS '存储系统用户信息';
COMMENT ON COLUMN users.email IS '用户邮箱地址，用于登录和通知';
```

### 十、总结

`CREATE TABLE` 语句的核心组件：
- **表名**：标识表的名称
- **列定义**：列名 + 数据类型 + 约束
- **约束**：保证数据完整性的规则（PRIMARY KEY, UNIQUE, NOT NULL, CHECK, FOREIGN KEY）
- **默认值**：列的初始值

掌握创建表的语法是数据库设计的基础，好的表结构设计能大大提高数据操作的效率和可靠性。